!function(){"use strict";angular.module("arth.lib",["arth.cursor","arth.tokenized","arth.tplloader","arth.svc.InputSelection","arth.parser.svc"])}();
!function(e,t){"use strict";function n(e){function t(e){if("INPUT"!==e.prop("tagName")||e.prop("type")&&"text"!==e.prop("type"))throw"This directive should be applied to input[type=text] element.";return n}function n(e,t,n,r){}var o={restrict:"A",controller:r,compile:t};return o}function r(e,n,r,o,u,i){function a(){return u.setSelection(n,h.$viewValue.start,h.$viewValue.end,h.$viewValue.dir),h}function l(e){return V(e,h.$viewValue)?h:(e||(e={}),f(h.$viewValue,e.start,e.end,e.dir),h)}function s(t){return t||(t={}),h.$modelValue||(h.$modelValue=m(e)),g&&V(g,h.$modelValue)?h:(f(h.$modelValue,t.start,t.end,t.dir),w(e,h.$modelValue),h)}function c(){var t,n=m(e);return v(n,h.$viewValue)?(f(n,n.pos,n.pos,!0),w(e,n),n):(h.$modelValue=n,t=h.$modelValue,h.$setViewValue(t).$render(),h.$modelValue.pos=h.$viewValue.pos,i.$$phase||e.$apply(),n)}function $(){S.forEach(function(e){n.on(e,p)})}function d(){S.forEach(function(e){n.off(e,p)})}function p(t){h.$viewValue=u.getSelection(n),y&&!i.$$phase&&e.$apply(function(){h.$setModelValue(h.$viewValue)})}function f(e,t,n,r){var o=Math.min(t,n),u=Math.max(t,n),i=r,a=i?u:o;return e.start=o,e.end=u,e.dir=i,e.pos=a,e}function V(e,t){if(!e||!t)return!1;var n=!0;return n=n&&e.start===t.start,n=n&&e.end===t.end,n=n&&e.dir===t.dir,n=n&&e.pos===t.pos}function v(e,t){if(!e||!t)return!1;var n=!0;return n=n&&e.start===t.start,n=n&&e.end===t.end,n=n&&e.dir===t.dir,n=n&&e.pos!==t.pos}var m,w,h=this,y=!!o[t];h.$setModelValue=s,h.$setViewValue=l,h.$viewValue=u.getSelection(n),h.$render=a,y&&(m=r(o[t]),w=m.assign,e.$watch(o[t],c,!0),h.$setModelValue({start:0,end:0,pos:0,dir:void 0}));var S=["click","keyup","keydown","keypress","mousedown","mouseup","focus","blur"];$(),e.$on("$destroy",d);var g}e.directive(t,n),n.$inject=["InputSelection"],r.$inject=["$scope","$element","$parse","$attrs","InputSelection","$rootScope"]}(angular.module("arth.cursor",["arth.svc.InputSelection"]),"arthCursor");
!function(e,t){"use strict";function n(){return{require:[t,"ngModel"],restrict:"A",controller:r}}function r(e,n,r,i,o,a,s,l,c){function u(e){function t(e){var t=x.toModel.parse(e||"");return t}function n(e){var t=E.toView.parse(e||"");return t.join("")}function r(e,t){function n(e){~r||(r=e)}if(t)return e.join("");var r=-1,i=y.length;e.forEach(function(e,t){var r=y[t];r!==e&&(t>=i?n(t+1,"New Token, set cursor after it"):e===y[t+1]?n(t,"Removed Token, set cursor before next"):n(t+1,"Inserted Token, set cursor after next"),y[t]=e)}),i>e.length&&(n(e.length,"Was truncated: set after last new token"),y.splice(e.length));var o=e.join("");return f(o,r),o}var i=angular.isArray(e.commonExp)?e.commonExp:[e.commonExp],o=i.slice(),s=i.slice();e.maps.forEach(function(e){var t=e.reg[0];t.type=e.type||"param_mapping",t.template=e.tpl[1],t.mapping=e.vm,o.push(t);var n=e.reg[1];n.type=e.type||"param_mapping",n.template=e.tpl[0],n.mapping=e.mv,s.push(n)}),x=l.getRepeater(o,!0),E=l.getRepeater(s,!0),x.toModel=l.getMapping(o,!0),E.toView=l.getMapping(s,!0);var c=[t,r],u=[n];a.fillListProcesser(c,$.$parsers),a.fillListProcesser(c,P),a.fillListProcesser(u,$.$formatters),a.fillListProcesser(u,M),window.vm=t,window.mv=n}function p(e){for(var t=M.length,n=e;t--;)n=M[t](n,!0);return n}function f(e,t){var n=p(e);n!==$.$viewValue&&($.$setViewValue(n),$.$render(),g(t))}function g(e){if(~e&&"undefined"!=typeof e){var t=y.map(p).slice(0,e).join("").length;o(function(){s.setSelection(n,t,t,!0),S=t})}}function v(t){var r=s.getSelection(n),i=y.map(p);"undefined"==typeof r.start&&(r.end=r.start=i.join("").length);for(var a=null,l=null,c=0,u=0,f=y.length;f>=c&&(u==r.start&&null===a||u>r.start&&null===a&&(a=c-1),u>=r.end&&null===l&&(l=c),c!=f);c++){var g=y[c];u+=p(g).length}null===a&&(a=l),y.splice(a,l-a,t),i.splice(a,l-a,t),V.assign(e,y.join("")),o(function(){var e=i.slice(0,a).join("").length+p(t).length;s.setSelection(n,e,e,!0)})}function m(){h()}function d(e){h(p(e))}function h(t){"undefined"==typeof t&&(t="");var n=x.toModel.parse(t);y.length=0,n.forEach(function(e){y.push(e)}),V.assign(e,y.join("")),t!==$.$viewValue&&($.$setViewValue(t),$.$render())}function w(){return y.map(p).join("")}var $=n.controller("ngModel"),y=[],V=i(r.ngModel),j=i(r[t])(e),P=[],M=[];angular.extend(j,{addToken:v,setModelValue:d,setViewValue:h,getViewValue:w,clear:m}),u(j.modelviews);var x,E,S=0}function i(){function e(e,r){return Array.isArray(e)?(e.forEach(t(r)),n):n}function t(e){function t(t){var o="push";if(Array.isArray(t)){if(o=t[i],!~["push","unshift"].indexOf(o))throw new Error(n.name+": Wrong method ["+o+"] - push|unshift expected");t=t[r]}e[o](t)}var r=0,i=1;return t}var n=this;n.$name="ParseFormatService",this.getListProcesser=t,this.fillListProcesser=e}e.directive(t,n),e.service("ParseFormatService",i),n.$inject=[],r.$inject=["$scope","$element","$attrs","$parse","$timeout","ParseFormatService","InputSelection","ParserFactory","MappingParser"],i.$inject=[]}(angular.module("arth.tokenized",["arth.parser.svc","arth.svc.InputSelection"]),"arthTokenized");
!function(t){"use strict";function e(){function t(t,e,n){function a(a,r,u,i){return t.get(r,{cache:e}).then(function(t){var e=t.data;a.html(e);var r=n(a.contents())(u);return i?(a.replaceWith(r),r):a})}function r(t,e,n,r,i){return a(t,u(n,r),e,i)}return{uri:u,load:a,loadTpl:r}}function e(t){c.noCacheFn=t}function n(t){c.base_uri=t}function a(t){c.tpl_dir=t}function r(t){c.default_tplname=t}function u(t,e){var n=c.noCacheFn(t,e);return n=n===!1?"":"?"+n,c.base_uri+t+c.tpl_dir+(e||c.default_tplname)+n}function i(){return!1}var l=this,c={base_uri:"/modules/",tpl_dir:"/templates/",default_tplname:"index.html",noCacheFn:i};l.setBaseUri=n,l.setTplDir=a,l.setDefaultTplName=r,l.setNoCacheFn=e,l.uri=u,l.$get=t,t.$inject=["$http","$templateCache","$compile"]}t.provider("TplLoader",e),e.$inject=[]}(angular.module("arth.tplloader",[]));
!function(t){"use strict";function n(){function t(t){var o={start:n(t),end:e(t),dir:r(t)};return o.pos=o.dir?o.end:o.start,o}function n(t){return t[0].selectionStart}function e(t){return t[0].selectionEnd}function r(t){var n={none:void 0,forward:!0,backward:!1};return n[t[0].selectionDirection]}function o(t,n,e,r){n=n||0,e=e||0,t[0].setSelectionRange(Math.min(n,e),Math.max(n,e),"undefined"==typeof r?"none":r?"forward":"backward")}return{getSelection:t,getSelectionStart:n,getSelectionEnd:e,getSelectionDirection:r,setSelection:o}}t.factory("InputSelection",n)}(angular.module("arth.svc.InputSelection",[]));
!function(n){"use strict";function e(n){var e=[],r=e[0]=[];return new n([",","\n"],function(n,e){e?("\n"==n||"\x00"==n)&&(this.tokens.push(r),r=[]):r.push(n)})}function r(n){function e(e,r){return new n(e,function(n,e,t,i){if("\x00"!=n){if(!e)return r?void 0:n;switch(t.type){case"param_mapping":var u=i.slice(1,-2),o=t.template,c=!0;return u.forEach(function(n,e){var r=t.mapping[n];return"undefined"==typeof r?void(c=!1):void(o=o.replace(new RegExp("\\\\\\$"+(e+1),"g"),r))}),c?o:r?void 0:n;default:return n}}})}return e}function t(){function n(n,e){function r(n){o=n,s=!1,f.tokens=[];do i();while(!s);return f.tokens}function t(n,e,r){if(n){var t=f.doBuild?f.doBuild(n,e,c,r):n;"undefined"!=typeof t&&f.tokens.push(t)}}function i(){var n;u(),n=o.slice(0,a),t(n,!1),o=o.slice(a).replace(c,function(n){return t(n,!0,[].slice.call(arguments,0)),""}),o||(t("\x00",!0),s=!0)}function u(){var e,r,t=0;for(a=-1,c="";"undefined"!=typeof(e=n[t++]);)r=o[e.test?"search":"indexOf"](e),-1!=r&&(-1==a||a>r)&&(c=e,a=r);-1==a&&(a=o.length)}var o,c,a,f=this,s=!0;return n=angular.isArray(n)?n:[n],e&&(f.doBuild=e),f.parse=r,f}function e(e,r){function t(n,e){return"\x00"!==n?e?n:r?void 0:n:void 0}return new n(e,t)}function t(e,r){return function(t){function i(n,e,i){return"\x00"!==n?e?n.replace(i,function(n,e){return t[e]}):r?void 0:n:void 0}return new n(e,i)}}function i(e,t){var i=new r(n);return new i(e,t)}return n.getRepeater=e,n.getReplacer=t,n.getMapping=i,n}n.factory("ParserFactory",t),n.service("CSVParser",e),n.service("MappingParser",r),e.$inject=["ParserFactory"],r.$inject=["ParserFactory"],t.$inject=[]}(angular.module("arth.parser.svc",[]));